{% extends 'base/base.html' %}
{% block content %}

<div class="card">
    <div class="card-body">
        <h5 class="card-title">Update Information for {{ tb_patient.first_name }} {{ tb_patient.last_name }}</h5>
        
        <form method="post" enctype="multipart/form-data" class="row g-3">
            {% csrf_token %}

            <div class="col-md-4">
                {{ form.user_name.label_tag }}
                {{ form.user_name }}
                {{ form.user_name.errors }}
            </div>
            <div class="col-md-4">
                {{ form.identification_no.label_tag }}
                {{ form.identification_no }}
                {{ form.identification_no.errors }}
            </div>
            <div class="col-md-4">
                {{ form.identification_type.label_tag }}
                {{ form.identification_type }}
                {{ form.identification_type.errors }}
            </div>

            <div class="col-md-4">
                {{ form.first_name.label_tag }}
                {{ form.first_name }}
                {{ form.first_name.errors }}
            </div>
            <div class="col-md-4">
                {{ form.last_name.label_tag }}
                {{ form.last_name }}
                {{ form.last_name.errors }}
            </div>
            <div class="col-md-4">
                {{ form.dob.label_tag }}
                {{ form.dob }}
                {{ form.dob.errors }}
            </div>

            <div class="col-md-4">
                {{ form.diagnosis_date.label_tag }}
                {{ form.diagnosis_date }}
                {{ form.diagnosis_date.errors }}
            </div>
            <div class="col-md-4">
                {{ form.county.label_tag }}
                {{ form.county }}
                {{ form.county.errors }}
            </div>
            <div class="col-md-4">
                {{ form.tb_stage.label_tag }}
                {{ form.tb_stage }}
                {{ form.tb_stage.errors }}
            </div>

            <div class="col-md-4">
                {{ form.vaccine_received.label_tag }}
                {{ form.vaccine_received }}
                {{ form.vaccine_received.errors }}
            </div>
            <div class="col-md-4">
                {{ form.vaccine_effectiveness.label_tag }}
                {{ form.vaccine_effectiveness }}
                {{ form.vaccine_effectiveness.errors }}
            </div>

            {# Weekly Progress Section #}
            <div class="col-12">
                <h6 class="mt-3 mb-2">Weekly Progress</h6>
                <div class="row g-3">
                    <div class="col-md-2">
                        {{ form.week_1.label_tag }}
                        {{ form.week_1 }}
                        {{ form.week_1.errors }}
                    </div>
                    <div class="col-md-2">
                        {{ form.week_2.label_tag }}
                        {{ form.week_2 }}
                        {{ form.week_2.errors }}
                    </div>
                    <div class="col-md-2">
                        {{ form.week_3.label_tag }}
                        {{ form.week_3 }}
                        {{ form.week_3.errors }}
                    </div>
                    <div class="col-md-2">
                        {{ form.week_4.label_tag }}
                        {{ form.week_4 }}
                        {{ form.week_4.errors }}
                    </div>
                    <div class="col-md-2">
                        {{ form.week_5.label_tag }}
                        {{ form.week_5 }}
                        {{ form.week_5.errors }}
                    </div>
                    <div class="col-md-2">
                        {{ form.week_6.label_tag }}
                        {{ form.week_6 }}
                        {{ form.week_6.errors }}
                    </div>
                    <div class="col-md-2">
                        {{ form.week_7.label_tag }}
                        {{ form.week_7 }}
                        {{ form.week_7.errors }}
                    </div>
                    <div class="col-md-2">
                        {{ form.week_8.label_tag }}
                        {{ form.week_8 }}
                        {{ form.week_8.errors }}
                    </div>
                    <div class="col-md-2">
                        {{ form.week_9.label_tag }}
                        {{ form.week_9 }}
                        {{ form.week_9.errors }}
                    </div>
                    <div class="col-md-2">
                        {{ form.week_10.label_tag }}
                        {{ form.week_10 }}
                        {{ form.week_10.errors }}
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                {{ form.treatment_start_date.label_tag }}
                {{ form.treatment_start_date }}
                {{ form.treatment_start_date.errors }}
            </div>
            <div class="col-md-4">
                {{ form.treatment_end_date.label_tag }}
                {{ form.treatment_end_date }}
                {{ form.treatment_end_date.errors }}
            </div>
            <div class="col-md-12">
                {{ form.treatment_notes.label_tag }}
                {{ form.treatment_notes }}
                {{ form.treatment_notes.errors }}
            </div>

            <div class="col-md-12">
                {{ form.performance_status.label_tag }}
                {{ form.performance_status }}
                {{ form.performance_status.errors }}
            </div>
            <div class="col-md-4">
                {{ form.follow_up_date.label_tag }}
                {{ form.follow_up_date }}
                {{ form.follow_up_date.errors }}
            </div>

            <div class="text-center">
                <button type="submit" class="btn btn-primary">Update</button>
                <a href="{% url 'tb_patient_detail' tb_patient.pk %}" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </div>
</div>

{% endblock %}